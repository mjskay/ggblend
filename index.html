<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Blending and Compositing Algebra for ggplot2 • ggblend</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Blending and Compositing Algebra for ggplot2">
<meta name="description" content="Algebra of operations for blending, copying, adjusting, and compositing layers in ggplot2. Supports copying and adjusting the aesthetics or parameters of an existing layer, partitioning a layer into multiple pieces for re-composition, applying affine transformations to layers, and combining layers (or partitions of layers) using blend modes (including commutative blend modes, like multiply and darken). Blend mode support is particularly useful for creating plots with overlapping groups where the layer drawing order does not change the output; see Kindlmann and Scheidegger (2014) &lt;doi:10.1109/TVCG.2014.2346325&gt;.">
<meta property="og:description" content="Algebra of operations for blending, copying, adjusting, and compositing layers in ggplot2. Supports copying and adjusting the aesthetics or parameters of an existing layer, partitioning a layer into multiple pieces for re-composition, applying affine transformations to layers, and combining layers (or partitions of layers) using blend modes (including commutative blend modes, like multiply and darken). Blend mode support is particularly useful for creating plots with overlapping groups where the layer drawing order does not change the output; see Kindlmann and Scheidegger (2014) &lt;doi:10.1109/TVCG.2014.2346325&gt;.">
<meta property="og:image" content="https://mjskay.github.io/ggblend/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ggblend</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mjskay/ggblend/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="ggblend-blending-and-compositing-algebra-for-ggplot2">ggblend: Blending and compositing algebra for ggplot2<a class="anchor" aria-label="anchor" href="#ggblend-blending-and-compositing-algebra-for-ggplot2"></a>
</h1>
</div>
<!-- badges: start -->

<p><em>ggblend</em> is a small algebra of operations for blending, copying, adjusting, and compositing layers in <em>ggplot2</em>. It allows you to easily copy and adjust the aesthetics or parameters of an existing layer, to partition a layer into multiple pieces for re-composition, and to combine layers (or partitions of layers) using blend modes (like <code>"multiply"</code>, <code>"overlay"</code>, etc).</p>
<p><em>ggblend</em> requires R ≥ 4.2, as blending and compositing support was added in that version of R.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install <em>ggblend</em> from CRAN as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggblend"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of <em>ggblend</em> using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mjskay/ggblend"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="blending-within-one-geometry">Blending within one geometry<a class="anchor" aria-label="anchor" href="#blending-within-one-geometry"></a>
</h2>
<p>We’ll construct a simple dataset with two semi-overlapping point clouds. We’ll have two versions of the dataset: one with all the <code>"a"</code> points listed first, and one with all the <code>"b"</code> points listed first.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggblend/">ggblend</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu">ggdist</span><span class="fu">::</span><span class="fu">theme_ggdist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>  plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, lineheight <span class="op">=</span> <span class="fl">1.1</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>  plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>,</span>
<span>  panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray75"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">df_a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">0</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1</span><span class="op">)</span>, set <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span></span>
<span><span class="va">df_b</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">2</span><span class="op">)</span>, set <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_ab</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_a</span>, <span class="va">df_b</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>order <span class="op">=</span> <span class="st">"draw a then b"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_ba</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_b</span>, <span class="va">df_a</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>order <span class="op">=</span> <span class="st">"draw b then a"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_ab</span>, <span class="va">df_ba</span><span class="op">)</span></span></code></pre></div>
<p>A typical scatterplot of such data suffers from the problem that how many points appear to be in each group depends on the drawing order (<em>a then b</em> versus <em>b then a</em>):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">set</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">order</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"geom_point() without blending"</span>, subtitle <span class="op">=</span> <span class="st">"Draw order matters."</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-scatter_noblend-1.png" width="672"></p>
<p>A <em>commutative</em> blend mode, like <code>"multiply"</code> or <code>"darken"</code>, is one potential solution that does not depend on drawing order. We can apply a <code><a href="reference/blend.html">blend()</a></code> operation to geom_point()` to achieve this. There three ways to do this:</p>
<ul>
<li>
<code>blend(geom_point(...), "multiply")</code> (normal function application)</li>
<li>
<code>geom_point(...) |&gt; blend("multiply")</code> (piping)</li>
<li>
<code>geom_point(...) * blend("multiply")</code> (algebraic operations)</li>
</ul>
<p>Function application and piping are equivalent. <strong>In this case</strong>, all three approaches are equivalent. As we will see later, the multiplication approach is useful when we want a shorthand for applying the same operation to multiple layers in a list without combining those layers first (in other words, multiplication of operations over layers is <em>distributive</em> in an algebraic sense).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">set</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"multiply"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">order</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"geom_point(alpha = 0.5) |&gt; blend('multiply')"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Draw order does not matter, but color is too dark."</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-scatter_blend-1.png" width="672"></p>
<p>Now the output is identical no matter the draw order, although the output is quite dark.</p>
</div>
<div class="section level2">
<h2 id="partitioning-layers">Partitioning layers<a class="anchor" aria-label="anchor" href="#partitioning-layers"></a>
</h2>
<p>Part of the reason the output is very dark above is that all of the points are being multiply-blended together. When many objects (here, individual points) are multiply-blended on top of each other, the output tends to get dark very quickly.</p>
<p>However, we really only need the two sets to be multiply-blended with each other. Within each set, we can use regular alpha blending. To do that, we can partition the geometry by <code>set</code> and then blend. Each partition will be blended normally within the set, and then the resulting sets will be multiply-blended together just once:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">set</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/partition.html">partition</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">set</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"multiply"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">order</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"geom_point(alpha = 0.5) |&gt; partition(vars(set)) |&gt; blend('multiply')"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Light outside the intersection, but still dark inside the intersection."</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-scatter_partition_blend-1.png" width="672"></p>
<p>That’s getting there: points outside the intersection of the two sets look good, but the intersection is still a bit dark.</p>
<p>Let’s try combining two blend modes to address this: we’ll use a <code>"lighten"</code> blend mode (which is also commutative) to make the overlapping regions lighter, and then draw the <code>"multiply"</code>-blended version on top at an <code>alpha</code> of less than 1:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">set</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/partition.html">partition</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">set</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"lighten"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/partition.html">partition</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">set</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"multiply"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">order</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> </span>
<span>      <span class="st">"geom_point(size = 3, alpha = 0.5) |&gt; partition(vars(set)) |&gt; blend('lighten') + \ngeom_point(size = 3, alpha = 0.5) |&gt; partition(vars(set)) |&gt; blend('multiply', alpha = 0.5)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">'A good compromise, but a long specification.'</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>lineheight <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-scatter_lighten_multiply-1.png" width="672"></p>
<p>Now it’s a little easier to see both overlap and density, and the output remains independent of draw order.</p>
<p>However, it is a little verbose to need to copy out a layer multiple times:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span> <span class="fu">partition</span>(<span class="fu">vars</span>(set)) <span class="sc">*</span> <span class="fu">blend</span>(<span class="st">"lighten"</span>) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span> <span class="fu">partition</span>(<span class="fu">vars</span>(set)) <span class="sc">*</span> <span class="fu">blend</span>(<span class="st">"multiply"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span></code></pre></div>
<p>We can simplify this is two ways: first, <code>partition(vars(set))</code> is equivalent to setting <code>aes(partition = set)</code>, so we can move the partition specification into the global plot aesthetics, since it is the same on every layer.</p>
<p>Second, operations and layers in <em>ggblend</em> act as a small algebra. Operations and sums of operations can be multiplied by layers and lists of layers, and those operations are distributed over the layers (This is where <code>*</code> and <code>|&gt;</code> differ: <code>|&gt;</code> does not distribute operations like <code><a href="reference/blend.html">blend()</a></code> over layers, which is useful if you want to use a blend to combine multiple layers together, rather than applying that blend to each layer individually).</p>
<p>Thus, we can “factor out” <code>geom_point(size = 3, alpha = 0.5)</code> from the above expression, yielding this:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"lighten"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"multiply"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Both expressions are equivalent. Thus we can rewrite the previous example like so:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">set</span>, partition <span class="op">=</span> <span class="va">set</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"lighten"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"multiply"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">order</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"geom_point(aes(partition = set)) * (blend('lighten') + blend('multiply', alpha = 0.5))"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Two order-independent blends on one layer using the distributive law."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>lineheight <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-scatter_lighten_multiply_stacked-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="blending-multiple-geometries">Blending multiple geometries<a class="anchor" aria-label="anchor" href="#blending-multiple-geometries"></a>
</h2>
<p>We can also blend geometries together by passing a list of geometries to <code><a href="reference/blend.html">blend()</a></code>. These lists can include already-blended geometries:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">set</span>, partition <span class="op">=</span> <span class="va">set</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"lighten"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"multiply"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"gray75"</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"gray75"</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"hard.light"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">order</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Blending multiple geometries together in a list"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Careful! The point layer blend is incorrect!"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-scatter_blend_geom_incorrect-1.png" width="672"></p>
<p>Whoops!! If you look closely, the blending of the <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> layers appears to have changed. Recall that this expression:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"lighten"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"multiply"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Is equivalent to specifying two separate layers, one with <code>blend("lighten")</code> and the other with <code>blend("multiply", alpha = 0.65))</code>. Thus, when you apply <code>|&gt; blend("hard.light")</code> to the <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> of layers, it will use a hard light blend mode to blend these two layers together, when previously they would be blended using the normal (or <code>"over"</code>) blend mode.</p>
<p>We can gain back the original appearance by blending these two layers together with <code>|&gt; blend()</code> prior to applying the hard light blend:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">set</span>, partition <span class="op">=</span> <span class="va">set</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"lighten"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"multiply"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"gray75"</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"gray75"</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"hard.light"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">order</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Blending multiple geometries together"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-scatter_blend_geom-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="partitioning-and-blending-lineribbons">Partitioning and blending lineribbons<a class="anchor" aria-label="anchor" href="#partitioning-and-blending-lineribbons"></a>
</h2>
<p>Another case where it’s useful to have finer-grained control of blending within a given geometry is when drawing overlapping uncertainty bands. Here, we’ll show how to use <code><a href="reference/blend.html">blend()</a></code> with <code>stat_lineribbon()</code> from <a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a> to create overlapping gradient ribbons depicting uncertainty.</p>
<p>We’ll fit a model:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_mpg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span> <span class="op">*</span> <span class="va">cyl</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<p>And generate some confidence distributions for the mean using <a href="https://pkg.mitchelloharawild.com/distributional/" class="external-link">distributional</a>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cyl"</span>, <span class="st">"hp"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predictions</span><span class="op">$</span><span class="va">mu_hat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m_mpg</span>, newdata <span class="op">=</span> <span class="va">predictions</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>  <span class="fu">distributional</span><span class="fu">::</span><span class="fu">dist_student_t</span><span class="op">(</span>df <span class="op">=</span> <span class="va">df</span>, mu <span class="op">=</span> <span class="va">fit</span>, sigma <span class="op">=</span> <span class="va">se.fit</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">predictions</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="do">##                     cyl  hp                     mu_hat</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="do">## Mazda RX4             6 110 t(28, 20.28825, 0.7984429)</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="do">## Datsun 710            4  93 t(28, 25.74371, 0.8818612)</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="do">## Hornet Sportabout     8 175 t(28, 15.56144, 0.8638133)</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="do">## Valiant               6 105 t(28, 20.54952, 0.8045354)</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="do">## Duster 360            8 245 t(28, 14.66678, 0.9773475)</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="do">## Merc 240D             4  62   t(28, 28.58736, 1.21846)</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="do">## Merc 230              4  95 t(28, 25.56025, 0.9024699)</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="do">## Merc 280              6 123  t(28, 19.60892, 0.842354)</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="do">## Merc 450SE            8 180 t(28, 15.49754, 0.8332276)</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="do">## Cadillac Fleetwood    8 205 t(28, 15.17801, 0.7674501)</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="do">## Lincoln Continental   8 215 t(28, 15.05021, 0.7866649)</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="do">## Chrysler Imperial     8 230 t(28, 14.85849, 0.8606705)</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="do">## Fiat 128              4  66   t(28, 28.22044, 1.12188)</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="do">## Honda Civic           4  52  t(28, 29.50466, 1.491467)</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="do">## Toyota Corolla        4  65  t(28, 28.31217, 1.145154)</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="do">## Toyota Corona         4  97 t(28, 25.37679, 0.9280143)</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="do">## Dodge Challenger      8 150  t(28, 15.88096, 1.077004)</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="do">## Porsche 914-2         4  91 t(28, 25.92718, 0.8665404)</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="do">## Lotus Europa          4 113   t(28, 23.9091, 1.262843)</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="do">## Ford Pantera L        8 264  t(28, 14.42394, 1.166062)</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="do">## Ferrari Dino          6 175  t(28, 16.89163, 1.550885)</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="do">## Maserati Bora         8 335   t(28, 13.5165, 2.045807)</span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="do">## Volvo 142E            4 109  t(28, 24.27603, 1.162526)</span></span></code></pre></div>
<p>A basic plot based on examples in <code><a href="https://mjskay.github.io/ggdist/articles/freq-uncertainty-vis.html" class="external-link">vignette("freq-uncertainty-vis", package = "ggdist")</a></code> and <code><a href="https://mjskay.github.io/ggdist/articles/lineribbon.html" class="external-link">vignette("lineribbon", package = "ggdist")</a></code> may have issues when lineribbons overlap:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hp</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu">stat_lineribbon</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ydist <span class="op">=</span> <span class="va">mu_hat</span>, fill_ramp <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">.width</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ppoints.html" class="external-link">ppoints</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu">scale_fill_ramp_continuous</span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"ggdist::stat_lineribbon()"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Overlapping lineribbons obscure each other."</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"cyl"</span>, fill <span class="op">=</span> <span class="st">"cyl"</span>, y <span class="op">=</span> <span class="st">"mpg"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-lineribbon_noblend-1.png" width="672"></p>
<p>Notice the overlap of the orange (<code>cyl = 6</code>) and purple (<code>cyl = 8</code>) lines.</p>
<p>If we add a <code>partition = cyl</code> aesthetic mapping, we can blend the geometries for the different levels of <code>cyl</code> together with a <code><a href="reference/blend.html">blend()</a></code> call around <code>ggdist::stat_lineribbon()</code>.</p>
<p>There are many ways we could add the partition to the plot:</p>
<ol style="list-style-type: decimal">
<li>Add <code>partition = cyl</code> to the existing <code>aes(...)</code> call. However, this leaves the partitioning information far from the call to <code><a href="reference/blend.html">blend()</a></code>, so the relationship between them is less clear.</li>
<li>Add <code>aes(partition = cyl)</code> to the <code>stat_lineribbon(...)</code> call. This is a more localized change (better!), but will raise a warning if <code>stat_lineribbon()</code> itself does not recognized the <code>partition</code> aesthetic.</li>
<li>Add <code>|&gt; adjust(aes(partition = cyl))</code> after <code>stat_lineribbon(...)</code> to add the <code>partition</code> aesthetic to it (this will bypass the warning).</li>
<li>Add <code>|&gt; partition(vars(cyl))</code> after <code>stat_lineribbon(...)</code> to add the <code>partition</code> aesthetic. This is an alias for the <code><a href="reference/adjust.html">adjust()</a></code> approach that is intended to be clearer. It takes a specification for a partition that is similar to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code>: either a one-sided formula or a call to <code><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars()</a></code>.</li>
</ol>
<p>Let’s try the fourth approach:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hp</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu">stat_lineribbon</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ydist <span class="op">=</span> <span class="va">mu_hat</span>, fill_ramp <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">.width</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ppoints.html" class="external-link">ppoints</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/partition.html">partition</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"multiply"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu">scale_fill_ramp_continuous</span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"ggdist::stat_lineribbon() |&gt; partition(vars(cyl)) |&gt; blend('multiply')"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Overlapping lineribbons blend together independent of draw order."</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"cyl"</span>, fill <span class="op">=</span> <span class="st">"cyl"</span>, y <span class="op">=</span> <span class="st">"mpg"</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-lineribbon_blend-1.png" width="672"></p>
<p>Now the overlapping ribbons are blended together.</p>
</div>
<div class="section level2">
<h2 id="highlighting-geoms-using-copy_under">Highlighting geoms using <code>copy_under()</code>
<a class="anchor" aria-label="anchor" href="#highlighting-geoms-using-copy_under"></a>
</h2>
<p>A common visualization technique to make a layer more salient (especially in the presence of many other competing layers) is to add a small outline around it. For some geometries (like <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code>) this is easy; but for others (like <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code>), there’s no easy way to do this without manually copying the layer.</p>
<p>The <em>ggblend</em> layer algebra makes this straightforward using the <code><a href="reference/adjust.html">adjust()</a></code> operation combined with operator addition and multiplication. For example, given a layer like:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>To add a white outline, you might want something like:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, linewidth <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>However, we’d rather not have to write the <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> specification twice If we factor out the differences between the first and second layer, we can use the <code><a href="reference/adjust.html">adjust()</a></code> operation (which lets you change the aesthetics and parameters of a layer) along with the distributive law to factor out <code>geom_line(linewidth = 1)</code> and write the above specification as:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="reference/adjust.html">adjust</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, linewidth <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>The <code>copy_under(...)</code> operation, which is a synonym for <code>adjust(...) + 1</code>, also implements this pattern:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="reference/copy.html">copy_under</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, linewidth <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></code></pre></div>
<p>Here’s an example highlighting the fit lines from our previous lineribbon example:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hp</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu">stat_ribbon</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ydist <span class="op">=</span> <span class="va">mu_hat</span>, fill_ramp <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">.width</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ppoints.html" class="external-link">ppoints</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/partition.html">partition</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"multiply"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">mu_hat</span><span class="op">)</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/copy.html">copy_under</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, linewidth <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu">scale_fill_ramp_continuous</span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"geom_line() |&gt; copy_under(color = 'white', linewidth = 2.5)"</span>, </span>
<span>    subtitle <span class="op">=</span> <span class="st">"Highlights the line layer without manually copying its specification."</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"cyl"</span>, fill <span class="op">=</span> <span class="st">"cyl"</span>, y <span class="op">=</span> <span class="st">"mpg"</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-lineribbon_blend_highlight-1.png" width="672"></p>
<p>Note that the implementation of <code>copy_under(...)</code> is simply a synonym for <code>adjust(...) + 1</code>; we can see this if we look at <code><a href="reference/copy.html">copy_under()</a></code> itself:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/copy.html">copy_under</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="do">## &lt;operation&gt;: (adjust() + 1)</span></span></code></pre></div>
<p>In fact, not that it is particularly useful, but addition and multiplication of layer operations is expanded appropriately:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fu"><a href="reference/adjust.html">adjust</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="do">## &lt;operation&gt;: (adjust() + 1 + 1 + 1 + adjust() + 1 + 1 + 1)</span></span></code></pre></div>
<p>I hesitate to imagine what that feature might be useful for…</p>
</div>
<div class="section level2">
<h2 id="compatibility-with-other-packages">Compatibility with other packages<a class="anchor" aria-label="anchor" href="#compatibility-with-other-packages"></a>
</h2>
<p>In theory <em>ggblend</em> should be compatible with other packages, though in more complex cases (blending lists of geoms or using the <code>partition</code> aesthetic) it is possible it may fail, as these features are a bit more hackish. I have done some testing with a few other layer-manipulating packages—including <a href="https://gganimate.com/" class="external-link">gganimate</a>, <a href="https://eliocamp.github.io/ggnewscale/" class="external-link">ggnewscale</a>, and <a href="https://github.com/clauswilke/relayer" class="external-link">relayer</a>—and they appear to be compatible.</p>
<p>As a hard test, here is all three features applied to a modified version of the Gapminder example used in the <a href="https://gganimate.com/" class="external-link">gganimate documentation</a>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com" class="external-link">gganimate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jennybc/gapminder" class="external-link">gapminder</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="va">gapminder</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">gdpPercap</span>, <span class="va">lifeExp</span>, size <span class="op">=</span> <span class="va">pop</span>, color <span class="op">=</span> <span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>size <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/partition.html">partition</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"multiply"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">70</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span>, color <span class="op">=</span> <span class="st">"gray75"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/blend.html">blend</a></span><span class="op">(</span><span class="st">"hard.light"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    <span class="co"># same as colorspace::lighten(continent_colors, 0.35)</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      Africa <span class="op">=</span> <span class="st">"#BE7658"</span>, Americas <span class="op">=</span> <span class="st">"#E95866"</span>, Asia <span class="op">=</span> <span class="st">"#7C5C86"</span>, </span>
<span>      Europe <span class="op">=</span> <span class="st">"#659C5D"</span>, Oceania <span class="op">=</span> <span class="st">"#7477CA"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/dollar_format.html" class="external-link">label_dollar</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">80</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">'Gapminder with gganimate and ggblend'</span>, </span>
<span>    subtitle <span class="op">=</span> <span class="st">'Year: {frame_time}'</span>, </span>
<span>    x <span class="op">=</span> <span class="st">'GDP per capita'</span>, </span>
<span>    y <span class="op">=</span> <span class="st">'Life expectancy'</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">transition_time</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ease_aes</span><span class="op">(</span><span class="st">'linear'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">animate</span><span class="op">(</span><span class="va">p</span>, type <span class="op">=</span> <span class="st">"cairo"</span>, width <span class="op">=</span> <span class="fl">600</span>, height <span class="op">=</span> <span class="fl">400</span>, res <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-gapminder-1.gif"><!-- --></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ggblend" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/mjskay/ggblend/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mjskay/ggblend/issues/new" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggblend</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="http://www.mjskay.com" class="external-link">Matthew Kay</a> <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0001-9446-0419" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://CRAN.R-project.org/package=ggblend" class="external-link"><img src="https://www.r-pkg.org/badges/version/ggblend" alt="CRAN status"></a></li>
<li><a href="https://app.codecov.io/gh/mjskay/ggblend?branch=main" class="external-link"><img src="https://codecov.io/gh/mjskay/ggblend/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/mjskay/ggblend/actions" class="external-link"><img src="https://github.com/mjskay/ggblend/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://doi.org/10.5281/zenodo.7963886" class="external-link"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.7963886.svg" alt="DOI"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://www.mjskay.com" class="external-link">Matthew Kay</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
